# Serverless-with-API-Gateway-Lambda-and-SQS
"Happy Serverless Trigger"

![image alt](https://github.com/Tatenda-Prince/Serverless-with-API-Gateway-Lambda-and-SQS/blob/a0e30fe1b50dc289d86f9a7bca792c79b61eaec1/Imagess/Screenshot%202024-12-26%20133713.png)

# Intro

Today we are going serverless with Amazon API Gateway, AWS Lambda and Amazon SQS.

We’ll create Python automation scripts, using the Boto3 library, to interact with AWS services and leverage the seamless integration of AWS’s serverless services.

For those who are not familiar, serverless means being able to run your code without provisioning or managing servers. By using this decoupled architecture of API Gateway, Lambda and SQS, you can take advantage of the benefits of serverless computing, like cost savings, scalability and reduced operational overhead.

# Background

# Amazon API Gateway

Amazon API Gateway is an AWS service used for creating, publishing, maintaining, monitoring and securing REST, HTTP and WebSocket APIs at any scale.

# Boto3

Boto3 provides a Python API for AWS infrastructure services. Using the SDK for Python, you can directly create, update and delete AWS resources using Python scripts.


# AWS Lambda

AWS Lambda is a serverless compute service that runs your code as functions in response to events and automatically manages the underlying compute resources for you.

# Amazon SQS

Amazon SQS is a managed distributed queue system that enables web service applications to queue messages generated by a component in the application to be consumed by another component. The queue acts as a temporary repository for messages that awaiting processing.

# Prerequisites

AWS Account with an IAM User

Basic knowledge of the Python Programming Language

Basic knowledge and use of an Interactive Development Environment (IDE)

AWS CLI installed and configured on local machine

# Overview of steps

These are the steps we will be aiming to accomplish

1.Create a Standard SQS Queue using Python and Boto3

2.Create a Lambda function in the console with a Python 3.7 or higher runtime

3.Modify the Lambda function to send a message that contains the current time to the SQS queue. Test the function using Lambda’s built-in test case

4.Create an HTTP API using API Gateway as a trigger to the Lambda function

5.Test the trigger to verify that the message was sent

# Step 1: Create a Standard SQS Queue using Python.

We will use the Boto3 Python library to create a script to automate the creation of a Standard SQS Queue. The source code is displayed below and can also be viewed or cloned from my GitHub.

![image alt]()


Let’s talk about what is happening in this script.

The first line imports the Boto3 library. The second line of the script creates an SQS resource by passing in the region name as a parameter.

The third line of the script creates a new queue in the SQS service with a custom name “rextech_queue” using the “create_queue” method of the SQS resource.

The fourth line of the script prints out the queue’s attributes, getting the name of the queue and its URL and concatenates them together to form a string.

Now that you understand the script, proceed by running it in your local environment.

If you navigate to your SQS services, you should now be able to see your newly created SQS queue.

![image alt](https://github.com/Tatenda-Prince/Serverless-with-API-Gateway-Lambda-and-SQS/blob/73e7c7f2461aac428c2758f28cb452aedecf225c/Imagess/Screenshot%202024-12-22%20122354.png)

Now that the SQS queue has been created, we can proceed to Step 2— Creating the Lambda function.

# Step 2: Create a Lambda function to send a message to SQS queue

Navigate to the Lambda service in the AWS Management Console and click “Create Function”.

Select “Author from scratch”, name the function, then choose Python 3.7 or greater Runtime. Leave the rest of the settings at default and click “Create function”.


![image alt](https://github.com/Tatenda-Prince/Serverless-with-API-Gateway-Lambda-and-SQS/blob/a7b224159fa41aed456c3cb9a7a8410f0cbd7912/Imagess/Screenshot%202024-12-22%20123337.png)


You will then change the default execution role and use an exiting role to give the Lambda function adequate permissions to interact with the SQS service.

To accomplish this, select the “Configuration” tab in your Lambda function’s dashboard, click “Permissions”, then click the current “Role name”.


![image alt](https://github.com/Tatenda-Prince/Serverless-with-API-Gateway-Lambda-and-SQS/blob/d0419f64d66f4f9745a95b31432b539aa4499ab1/Imagess/Screenshot%202024-12-26%20135903.png)

A new window should open up. In that new window, select “Add policies”.


![image alt](https://github.com/Tatenda-Prince/Serverless-with-API-Gateway-Lambda-and-SQS/blob/4d80226c3190c73d9e568d1a85b43e8d69dff3f7/Imagess/Screenshot%202024-12-22%20123505.png)


Next, type “SQS” in the search box and hit enter. Select the “AmazonSQSFullAccess” role, then click “Add permissions”.

Note — For demonstration purposes we will be use the full access role, however, we should always strive to practice the principle of least privilege, granting only the minimum required permissions needed.


![image alt](https://github.com/Tatenda-Prince/Serverless-with-API-Gateway-Lambda-and-SQS/blob/57952aedfbe93fda9717852ce93c57d1a48b124a/Imagess/Screenshot%202024-12-22%20123536.png)

You can now verify that the SQS IAM policy is attached to the Lambda function.

![image alt](https://github.com/Tatenda-Prince/Serverless-with-API-Gateway-Lambda-and-SQS/blob/76bd18aee9a0b5a7de5dc1c89b8317c50ec8311f/Imagess/Screenshot%202024-12-22%20123628.png)


Now that the Lambda function has been created and assigned the necessary permissions, we can proceed to Step 3 — Modifying the Lambda function to send a message to the SQS queue.

# Step 3: Modify the Lambda to send a message to the SQS queue.

In the overview window of the Lambda function, copy and paste the code below into the code tab. You can also view it or clone it from my GitHub repo.

![image alt]()

















